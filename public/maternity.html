<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>모성보호 지원 신청서 - LOFA</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f4f7f9; padding: 40px 0; font-family: 'Malgun Gothic', sans-serif; }
        .form-card { background: white; border-radius: 15px; padding: 40px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); }
        .header-line { border-left: 5px solid #fd79a8; padding-left: 15px; margin-bottom: 30px; }
        .section-title { font-size: 1.1rem; font-weight: bold; color: #d63031; margin-top: 25px; margin-bottom: 15px; border-bottom: 2px solid #e9ecef; padding-bottom: 5px; }
        .info-text { background-color: #fff5f7; border-radius: 10px; padding: 15px; font-size: 0.9rem; color: #444; border: 1px solid #fab1a0; }
        .confidential-box { background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 15px; font-size: 0.85rem; color: #636e72; line-height: 1.6; }
    </style>
</head>
<body>
<div class="container" style="max-width: 800px;">
    <div class="form-card">
        <div class="header-line">
            <h2 class="fw-bold">모성보호 지원 신청서</h2>
            <p class="text-muted mb-0">임신 및 난임 치료 지원을 위한 임직원 전용 신청 양식입니다.</p>
        </div>

        <form id="maternityForm" enctype="multipart/form-data">
            <input type="hidden" name="type" value="모성보호지원">

            <div class="section-title">1. 신청인 정보</div>
            <div class="row g-3">
                <div class="col-md-4"><label class="form-label fw-bold">소속부서</label><input type="text" name="department" class="form-control" required></div>
                <div class="col-md-4"><label class="form-label fw-bold">직급</label><input type="text" name="position" class="form-control" required></div>
                <div class="col-md-4"><label class="form-label fw-bold">사번</label><input type="text" name="employeeId" class="form-control" required></div>
                <div class="col-md-4"><label class="form-label fw-bold">성명</label><input type="text" name="employeeName" class="form-control" value="{{ user_name }}" readonly></div>
                <div class="col-md-4"><label class="form-label fw-bold">입사일</label><input type="date" name="joinDate" class="form-control" required></div>
                <div class="col-md-4"><label class="form-label fw-bold">전화번호</label><input type="tel" name="phone" class="form-control" required></div>
            </div>

            <div class="section-title">2. 지원 신청 내용</div>
            <div class="row g-3">
                <div class="col-md-12">
                    <label class="form-label fw-bold">지원 항목 선택</label>
                    <select name="maternity_type" class="form-select" required>
                        <option value="" disabled selected>항목을 선택하세요</option>
                        <option value="임신관련 지원">임신 관련 지원</option>
                        <option value="난임 치료 지원">난임 치료 지원</option>
                    </select>
                </div>
                <div class="col-md-6">
                    <label class="form-label fw-bold">신청 금액</label>
                    <input type="number" name="amount" class="form-control" placeholder="숫자만 입력" required>
                </div>
                <div class="col-md-6">
                    <label class="form-label fw-bold">지급 계좌번호</label>
                    <input type="text" name="account" class="form-control" placeholder="은행명 및 계좌번호" required>
                </div>
            </div>

            <div class="section-title">3. 증빙서류 및 안내사항</div>
            <div class="info-text mb-3">
                <strong>[제출 서류 목록]</strong><br>
                - 임신확인서 또는 난임진단서 등 사실 확인 증빙서류 1부
            </div>

            <div class="mb-4">
                <label class="form-label fw-bold">증빙 파일 업로드</label>
                <input type="file" name="attachment" class="form-control">
            </div>

            <div class="confidential-box mb-4">
                <p class="mb-2"><strong>[기금운영규정 관련 주의사항]</strong></p>
                <ul>
                    <li><strong>규정 제53조 4항:</strong> 임신사실이 객관적으로 확인되어 지원이 이루어진 경우, 어떠한 경우에도 지원금을 환수하지 않습니다.</li>
                    <li><strong>규정 제59조:</strong> 기금 담당자 및 업무 관련자는 업무수행 과정에서 알게 된 정보를 절대 누설하지 않으며 철저히 비밀을 유지합니다.</li>
                </ul>
            </div>

            <div class="d-grid gap-2">
                <button type="submit" class="btn btn-lg text-white" style="background-color: #fd79a8; border: none;">모성보호 지원 신청</button>
                <a href="/" class="btn btn-light">이전 메뉴로</a>
            </div>
        </form>
    </div>
</div>

<script>
document.getElementById('maternityForm').onsubmit = async (e) => {
    e.preventDefault();
    const formData = new FormData(e.target);
    
    // 엑셀 기록용 요약 정보 조합
    const summary = `항목:${formData.get('maternity_type')}, 부서:${formData.get('department')}, 연락처:${formData.get('phone')}, 계좌:${formData.get('account')}, 금액:${formData.get('amount')}`;
    
    formData.append('sub_type', formData.get('maternity_type'));
    formData.append('content', summary);

    const res = await fetch('/submit', { method: 'POST', body: formData });
    const data = await res.json();
    if(data.status === 'success') {
        alert('모성보호 지원 신청서가 정상적으로 접수되었습니다.');
        location.href = '/';
    } else {
        alert('신청 실패: ' + data.message);
    }
};
</script>
</body>
</html>