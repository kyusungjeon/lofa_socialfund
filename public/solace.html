<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>위로금 지원 신청서 - LOFA</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f4f7f9; padding: 40px 0; font-family: 'Malgun Gothic', sans-serif; }
        .form-card { background: white; border-radius: 15px; padding: 40px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); }
        .header-line { border-left: 5px solid #2d3436; padding-left: 15px; margin-bottom: 30px; }
        .section-title { font-size: 1.1rem; font-weight: bold; color: #2d3436; margin-top: 25px; margin-bottom: 15px; border-bottom: 2px solid #e9ecef; padding-bottom: 5px; }
        .info-text { background-color: #f8f9fa; border-radius: 10px; padding: 15px; font-size: 0.9rem; color: #444; border: 1px solid #dfe6e9; }
        .highlight-box { border: 1px solid #fab1a0; background-color: #fff5f5; padding: 15px; border-radius: 10px; font-size: 0.85rem; color: #c0392b; }
    </style>
</head>
<body>
<div class="container" style="max-width: 850px;">
    <div class="form-card">
        <div class="header-line">
            <h2 class="fw-bold">위로금 지원 신청서</h2>
            <p class="text-muted mb-0">중증질환 및 불의의 사고로 인한 위로금 신청 양식입니다.</p>
        </div>

        <form id="solaceForm" enctype="multipart/form-data">
            <input type="hidden" name="type" value="위로금지원">

            <div class="section-title">1. 신청인(임직원) 정보</div>
            <div class="row g-3">
                <div class="col-md-4"><label class="form-label fw-bold">소속부서</label><input type="text" name="department" class="form-control" placeholder="예: 인프라팀" required></div>
                <div class="col-md-4"><label class="form-label fw-bold">직급</label><input type="text" name="position" class="form-control" placeholder="예: 차장" required></div>
                <div class="col-md-4"><label class="form-label fw-bold">사번</label><input type="text" name="employeeId" class="form-control" required></div>
                <div class="col-md-4"><label class="form-label fw-bold">성명</label><input type="text" name="employeeName" class="form-control" value="{{ user_name }}" readonly></div>
                <div class="col-md-4"><label class="form-label fw-bold">입사일</label><input type="date" name="joinDate" class="form-control" required></div>
                <div class="col-md-4"><label class="form-label fw-bold">전화번호</label><input type="tel" name="phone" class="form-control" placeholder="010-0000-0000" required></div>
            </div>

            <div class="section-title">2. 지원 신청 내용</div>
            <div class="row g-3">
                <div class="col-md-4">
                    <label class="form-label fw-bold">대상자 성명</label>
                    <input type="text" name="target_name" class="form-control" required>
                </div>
                <div class="col-md-4">
                    <label class="form-label fw-bold">질병진단일시</label>
                    <input type="date" name="diagnosis_date" class="form-control" required>
                </div>
                <div class="col-md-4">
                    <label class="form-label fw-bold">질병명</label>
                    <input type="text" name="disease_name" class="form-control" placeholder="진단서상 질병명" required>
                </div>
                <div class="col-md-6">
                    <label class="form-label fw-bold">신청 금액</label>
                    <input type="number" name="amount" class="form-control" placeholder="숫자만 입력" required>
                </div>
                <div class="col-md-6">
                    <label class="form-label fw-bold">지급 계좌번호</label>
                    <input type="text" name="account" class="form-control" placeholder="은행명 및 계좌번호" required>
                </div>
            </div>

            <div class="section-title">3. 증빙서류 제출 안내</div>
            <div class="highlight-box mb-3">
                <strong>[필수 제출 서류]</strong><br>
                - 4대 중증질환(암, 심장질환, 뇌혈관질환, 희귀난치성) 진단 증빙 서류 1부<br>
                - 대형사고로 인한 영구장애 판정 관련 진단서 1부<br>
                - 가족관계증명서 (대상자가 가족일 경우)
            </div>
            <div class="mb-4">
                <label class="form-label fw-bold">증빙 파일 업로드 (ZIP 압축 권장)</label>
                <input type="file" name="attachment" class="form-control">
            </div>

            <div class="d-grid gap-2">
                <button type="submit" class="btn btn-dark btn-lg">위로금 지원 신청하기</button>
                <a href="/" class="btn btn-light">이전 메뉴로</a>
            </div>
        </form>
    </div>
</div>

<script>
document.getElementById('solaceForm').onsubmit = async (e) => {
    e.preventDefault();
    const formData = new FormData(e.target);
    
    // 엑셀 요약 데이터 생성 (부서, 성명, 사번, 구분, 금액 정보 포함)
    const summary = `대상:${formData.get('target_name')}, 질병:${formData.get('disease_name')}, 진단일:${formData.get('diagnosis_date')}, 부서:${formData.get('department')}, 계좌:${formData.get('account')}`;
    
    formData.append('content', summary);

    const res = await fetch('/submit', {
        method: 'POST',
        body: formData
    });
    
    const data = await res.json();
    if(data.status === 'success') {
        alert('위로금 신청이 정상적으로 접수되었습니다. 빠른 쾌유를 빕니다.');
        location.href = '/';
    } else {
        alert('신청 실패: ' + data.message);
    }
};
</script>
</body>
</html>